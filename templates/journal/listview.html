{% extends "core/dashboard/base-patient-dash.html" %}
{% load staticfiles %}
{% block title %}Journal{% endblock %}
{% block head %}
    <link rel="stylesheet" href="{% static 'css/calendar.css' %}">
{% endblock %}
{% block body %}

    <div class="row">
        <div class="col-sm-5">
            <h3>History</h3>
            <nav>
                <ul class="pagination">
                    {% if entries.has_previous %}
                        <li class="page-item">
                            <a href="?page={{ entries.previous_page_number }}">
                                <span class="page-link" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                    <span class="sr-only">Previous</span>
                                </span>
                            </a>
                        </li>
                    {% else %}
                        <li class="page-item disabled">
                            <a href="#">
                                <span class="page-link" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                    <span class="sr-only">Previous</span>
                                </span>
                            </a>
                        </li>
                    {% endif %}

                    {% for page in paginator.page_range %}
                        <li {% if page == entries.number %} class="page-item active" {% else %} class="page-item"%}{% endif %}>
                            <a href="?page={{ page }}">
                                <span class="page-link" aria-label="Previous">
                                    <span aria-hidden="true">{{ page }}</span>
                                    <span class="sr-only">(current)</span>
                                </span>
                            </a>
                        </li>
                    {% endfor %}

                    {% if entries.has_next %}
                        <li class="page-item">
                            <a href="?page={{ entries.next_page_number }}">
                                <span class="page-link" aria-label="Previous">
                                    <span aria-hidden="true">&raquo;</span>
                                    <span class="sr-only">Next</span>
                                </span>
                            </a>
                        </li>
                    {% else %}
                        <li class="page-item disabled">
                            <a href="#">
                                <span class="page-link" aria-label="Previous">
                                    <span aria-hidden="true">&raquo;</span>
                                    <span class="sr-only">Next</span>
                                </span>
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
            <div id="listDiv">
                <table class="table table-striped table-bordered table-hover">
                    <tbody>
                    {% for entry in entries %}
                        <tr>
                            <td>
                                <div class="col-md-9">
                                    {{ entry.title }}
                                </div>
                                <div class="col-md-3">
                                    {{ entry.created|date:"M d, Y" }}
                                </div>
                            </td>
                        </tr>
                        <tr><td>{{ entry.entry|truncatechars:250 }}</td></tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <div class="col-sm-6">
            <div id="entryDiv">
                <form role="form" method="post" action="">
                    {% csrf_token %}
                    <h3>New Entry</h3>
                    <fieldset class="form-group">
                        <input id="title" name="title" class="form-control" placeholder="Title Your Entry">
                    </fieldset>
                    Letâ€™s take some time to check in with you. How have you been doing for the past week?
                    <textarea id="entry" name="entry" class="form-control" type="text"
                              style="resize: none; height: 500px;"
                              placeholder="What are the good and bad things that happened? How have you been feeling?  This is your chance to freely reflect- vent, brag, complain, rant, gush, whatever you feel like writing about!"></textarea>
                    <div id="feedbackUser"></div>
                    {% if entry_form.entry.errors %}
                        <div>{{ entry_form.entry.errors }}</div>
                    {% endif %}

                    <fieldset class="form-group">
                        <input type="submit" name="submit" id="submit" value="Submit" class="btn btn-primary pull-left"/>
                    </fieldset>

                    <fieldset class="form-group">
                        <div class="col-md-5">
                            <input id="created" name="created" type="hidden" class="form-control">
                        </div>
                    </fieldset>
            </div>
        </div>
    </div>

{% endblock %}


{% block js_scripts %}
    <script type="text/javascript">

        $('#journalSidebar').addClass('active');
        var d = new Date();
        $(document).ready(function () {
            document.getElementById("created").value = d.toISOString().replace("T", " ").substring(0, 16);
        });

        $("form").submit(function () {
            var $input = $(this).find("input[id=title]");
            if (!$input.val()) {
                $input.val(d.toDateString());
            }
        });
    </script>
{% endblock %}